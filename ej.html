<html>
<head>
    <title>Students</title>
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>

    <script type="text/javascript">
        //LLAMADAS AJAX
        // Obtener info de 1 estudiante
        function getStudent(){
            $.ajax({
            method: "GET",
            url: "server.com",
            dataType: "json",
            }).done(function(msg){
            showStudent(msg);
            }).fail(function(){
            alert(":(");
            });
        }
        // Obtener info de todos los estudiantes
        function getStudents(){
            $.ajax({
            method: "GET",
            url: "server.com",
            dataType: "json",
            }).done(function(msg){
            showStudents(msg);
            }).fail(function(){
            alert(":(");
            });
        }
        // Eliminar 1 estudiante
        function delStudent(){
            del = $('#DNI').val();
            $.ajax({
            method: "POST",
            url: "server.com?dni="+del,
            dataType: "json",
            }).done(function(msg){
            alert("Succes. Student deleted.");
            }).fail(function(){
            alert(":(");
            });
        }
        // Añadir 1 estudiante
        function addStudent(){
            dni = $('#aDNI').val();
            fname = $('#fname').val();
            lname = $('#surname').val();
            age = $('#age').val();
            $.ajax({
            method: "POST",
            url: "server.com?dni="+dni+"&name="+fname+"&surname="+lname+"&age="+age,
            dataType: "json",
            }).done(function(msg){
            alert("Succes. Student added.");
            }).fail(function(){
            alert(":(");
            });
        }
       
        // FUNCIONES 
        // Mostrar información del alumno.
        function showStudent(response) {
            $('#showAlumn').empty();
            /*
            {
                dni: '123456789W',
                name: 'Juan Carlos',
                surname: 'Salinas',
                age: '20'
            }
            */
            $('#showAlumn').append('<ul><li>Name: '+response["name"]+
                                '</li><br><li>Surname: '+response["surname"]+
                                '</li><br><li>Age: '+response["age"]+
                                '</li><br><li>ID: '+response["dni"]+
                                '</li></ul>');
        }

        function showStudents(response){
            $('#showAll tr').remove();
            /*
            [
                {
                    dni: '123456789W',
                    name: 'Juan Carlos',
                    surname: 'Salinas',
                    age: '20'
                },
                {
                    dni: '123456789W',
                    name: 'Juan Carlos',
                    surname: 'Salinas',
                    age: '20'
                },
                {
                    dni: '123456789W',
                    name: 'Juan Carlos',
                    surname: 'Salinas',
                    age: '20'
                }
            ]*/
            $('#showAll').append('<tr><td><b>Name</b></td><td><b>Surname</b></td><td><b>Age</b></td><td><b>ID</b></td></tr>');
            for (let index = 0; index < response.length; index++) {
                const student = response[index];
                $('#showAll').append('<tr><td>'+response["name"]+
                                    '</td><td>'+response["surname"]+
                                    '</td><td>'+response["age"]+
                                    '</td><td>'+response["dni"]+
                                    '</td></tr>');
            }
        }

    </script>
    <link rel="icon" href="http://telek.tk/shop/wp-content/uploads/2020/11/cropped-775123963378532353-32x32.png" sizes="32x32">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="formContainer">
        <div>
            <!--FORMULARIO INFO ALUMNO-->
            <label for="Name">Search Student</label>
            <input type="text" id="Name" name="Name" />
            <input type="submit" onclick="getStudent()">
        </div>
        
        <div>
            <!--BOTÓN MOSTRAR ALUMNOS-->
            <br>
            <button id="students" onclick="getStudents()">Show all students</button>
        </div>
        
        <div>
            <!--ELIMINAR ALUMNO-->
            <label for="DNI">Delete student</label>
            <input type="text" id="DNI" name="DNI" placeholder="Student ID"/>
            <input type="submit" onclick="delStudent()">
        </div>
        
        <div>
            <!--AÑADIR ALUMNO-->
            <form action="addAlumno">
                <label for="aDNI">ID:</label><br>
                <input type="text" id="aDNI" name="aDNI"><br>
                <label for="fname">First name:</label><br>
                <input type="text" id="fname" name="fname"><br>
                <label for="surname">Last Name:</label><br>
                <input type="text" id="surname" name="surname"><br>
                <label for="age">Age:</label><br>
                <input type="number" id="age" name="age"><br><br>
                <input type="submit" value="Submit">
            </form> 
        </div>
    </div>
    
    <div id="showAlumn"></div>

    <!--TABLA ALUMNOS (invisible)-->
    <table id="showAll" style="visibility: hidden; border: 1;" cellpadding="10">
    </table>

</body>
</html>